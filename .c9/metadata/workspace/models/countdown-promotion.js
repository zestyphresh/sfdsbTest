{"filter":false,"title":"countdown-promotion.js","tooltip":"/models/countdown-promotion.js","undoManager":{"mark":100,"position":100,"stack":[[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":56,"column":0},"end":{"row":56,"column":23}},"text":"              .value();"},{"action":"removeLines","range":{"start":{"row":47,"column":0},"end":{"row":56,"column":0}},"nl":"\n","lines":["            var result3 = _(json)","                .groupBy('o')","                .map(function(v, k) {","                    var sum = _.reduce(v, function(r, n) { ","                        return {'gv' : r.gv + n.gv, ","                                'qty' : r.qty + n.qty }","                    }, {'gv':0, 'qty':0})","                return {'o': k, 'gv' : sum.gv, 'qty' : sum.qty};","              })"]}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":48,"column":0},"end":{"row":48,"column":14}},"text":"              "},{"action":"removeLines","range":{"start":{"row":47,"column":0},"end":{"row":48,"column":0}},"nl":"\n","lines":[""]}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":47,"column":0},"end":{"row":48,"column":0}},"nl":"\n","lines":[""]}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":48,"column":24},"end":{"row":48,"column":28}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":48,"column":20},"end":{"row":48,"column":24}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":48,"column":16},"end":{"row":48,"column":20}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":48,"column":26},"end":{"row":48,"column":27}},"text":"o"},{"action":"insertText","range":{"start":{"row":48,"column":26},"end":{"row":48,"column":27}},"text":"o"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":48,"column":27},"end":{"row":48,"column":28}},"text":"w"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":48,"column":28},"end":{"row":48,"column":29}},"text":"n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":48,"column":29},"end":{"row":48,"column":30}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":48,"column":30},"end":{"row":48,"column":31}},"text":"r"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":51,"column":33},"end":{"row":51,"column":35}},"text":"gv"},{"action":"insertText","range":{"start":{"row":51,"column":33},"end":{"row":51,"column":43}},"text":"grossValue"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":51,"column":49},"end":{"row":51,"column":51}},"text":"gv"},{"action":"insertText","range":{"start":{"row":51,"column":49},"end":{"row":51,"column":59}},"text":"grossValue"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":51,"column":64},"end":{"row":51,"column":66}},"text":"gv"},{"action":"insertText","range":{"start":{"row":51,"column":64},"end":{"row":51,"column":74}},"text":"grossValue"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":52,"column":33},"end":{"row":52,"column":36}},"text":"qty"},{"action":"insertText","range":{"start":{"row":52,"column":33},"end":{"row":52,"column":41}},"text":"quantity"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":52,"column":47},"end":{"row":52,"column":50}},"text":"qty"},{"action":"insertText","range":{"start":{"row":52,"column":47},"end":{"row":52,"column":55}},"text":"quantity"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":52,"column":60},"end":{"row":52,"column":63}},"text":"qty"},{"action":"insertText","range":{"start":{"row":52,"column":60},"end":{"row":52,"column":68}},"text":"quantity"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":53,"column":25},"end":{"row":53,"column":27}},"text":"gv"},{"action":"insertText","range":{"start":{"row":53,"column":25},"end":{"row":53,"column":35}},"text":"grossValue"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":53,"column":41},"end":{"row":53,"column":44}},"text":"qty"},{"action":"insertText","range":{"start":{"row":53,"column":41},"end":{"row":53,"column":49}},"text":"quantity"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":54,"column":16},"end":{"row":54,"column":20}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":53,"column":54},"end":{"row":54,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":54,"column":0},"end":{"row":54,"column":20}},"text":"                    "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":49,"column":37},"end":{"row":50,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":50,"column":0},"end":{"row":50,"column":20}},"text":"                    "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":51,"column":59},"end":{"row":52,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":52,"column":0},"end":{"row":52,"column":24}},"text":"                        "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":54,"column":70},"end":{"row":55,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":55,"column":0},"end":{"row":55,"column":32}},"text":"                                "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":14},"end":{"row":59,"column":15}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":15},"end":{"row":59,"column":16}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":60,"column":14},"end":{"row":60,"column":15}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":60,"column":15},"end":{"row":60,"column":16}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":58,"column":68},"end":{"row":59,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":59,"column":0},"end":{"row":59,"column":20}},"text":"                    "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":85,"column":0},"end":{"row":85,"column":14}},"text":"            })"},{"action":"removeLines","range":{"start":{"row":62,"column":0},"end":{"row":85,"column":0}},"nl":"\n","lines":["            ","            _(_data[dataset])","                .groupBy('owner')","                .each(function(v, k) {","                    ","                    var result = {'owner' : k};","                    ","                    _.reduce(v, function(r, n, k) {","                    ","                        r['grossValue'] += n.grossValue;","                        r['quantity'] += n.quantity;","                        ","                    }, {'owner' : k});","                    ","                    ","                    ","                    ","                })","                ","                ","                ","                ","                "]},{"action":"removeText","range":{"start":{"row":63,"column":0},"end":{"row":63,"column":12}},"text":"            "},{"action":"removeLines","range":{"start":{"row":62,"column":0},"end":{"row":63,"column":0}},"nl":"\n","lines":[""]}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":58,"column":30},"end":{"row":58,"column":31}},"text":"w"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":58,"column":31},"end":{"row":58,"column":32}},"text":"n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":58,"column":32},"end":{"row":58,"column":33}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":58,"column":33},"end":{"row":58,"column":34}},"text":"r"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":58,"column":40},"end":{"row":59,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":59,"column":0},"end":{"row":59,"column":20}},"text":"                    "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":20},"end":{"row":59,"column":24}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":24},"end":{"row":59,"column":28}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":59,"column":29},"end":{"row":59,"column":31}},"text":"gv"},{"action":"insertText","range":{"start":{"row":59,"column":29},"end":{"row":59,"column":39}},"text":"grossValue"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":51},"end":{"row":60,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":60,"column":0},"end":{"row":60,"column":28}},"text":"                            "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":60,"column":29},"end":{"row":60,"column":32}},"text":"qty"},{"action":"insertText","range":{"start":{"row":60,"column":29},"end":{"row":60,"column":37}},"text":"quantity"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":60,"column":48},"end":{"row":61,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":61,"column":0},"end":{"row":62,"column":0}},"lines":["                        "]},{"action":"insertText","range":{"start":{"row":62,"column":0},"end":{"row":62,"column":20}},"text":"                    "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":60,"column":48},"end":{"row":60,"column":49}},"text":","}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":60,"column":49},"end":{"row":61,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":61,"column":0},"end":{"row":61,"column":28}},"text":"                            "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":28},"end":{"row":61,"column":30}},"text":"''"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":29},"end":{"row":61,"column":30}},"text":"v"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":30},"end":{"row":61,"column":31}},"text":"s"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":31},"end":{"row":61,"column":32}},"text":"T"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":32},"end":{"row":61,"column":33}},"text":"a"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":33},"end":{"row":61,"column":34}},"text":"r"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":34},"end":{"row":61,"column":35}},"text":"g"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":35},"end":{"row":61,"column":36}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":36},"end":{"row":61,"column":37}},"text":"t"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":38},"end":{"row":61,"column":39}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":39},"end":{"row":61,"column":40}},"text":":"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":40},"end":{"row":61,"column":41}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":41},"end":{"row":61,"column":63}},"text":"-target + r.grossValue"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":61,"column":51},"end":{"row":61,"column":63}},"text":"r.grossValue"},{"action":"insertText","range":{"start":{"row":61,"column":51},"end":{"row":61,"column":57}},"text":"sum.gv"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":57},"end":{"row":61,"column":58}},"text":","}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":62,"column":24},"end":{"row":62,"column":28}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":62,"column":28},"end":{"row":62,"column":71}},"text":"vsTargetPercentage = r.grossValue / target;"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":62,"column":28},"end":{"row":62,"column":29}},"text":"'"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":62,"column":47},"end":{"row":62,"column":48}},"text":"'"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":62,"column":49},"end":{"row":62,"column":50}},"text":"="}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":62,"column":49},"end":{"row":62,"column":50}},"text":":"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":59,"column":47},"end":{"row":59,"column":49}},"text":"gv"},{"action":"insertText","range":{"start":{"row":59,"column":47},"end":{"row":59,"column":48}},"text":"g"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":48},"end":{"row":59,"column":49}},"text":"r"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":49},"end":{"row":59,"column":50}},"text":"o"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":50},"end":{"row":59,"column":51}},"text":"s"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":51},"end":{"row":59,"column":52}},"text":"s"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":52},"end":{"row":59,"column":53}},"text":"V"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":53},"end":{"row":59,"column":54}},"text":"a"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":54},"end":{"row":59,"column":55}},"text":"l"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":55},"end":{"row":59,"column":56}},"text":"u"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":56},"end":{"row":59,"column":57}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":61,"column":56},"end":{"row":61,"column":57}},"text":"v"},{"action":"insertText","range":{"start":{"row":61,"column":56},"end":{"row":61,"column":57}},"text":"r"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":57},"end":{"row":61,"column":58}},"text":"o"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":58},"end":{"row":61,"column":59}},"text":"s"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":59},"end":{"row":61,"column":60}},"text":"s"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":60},"end":{"row":61,"column":61}},"text":"V"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":61},"end":{"row":61,"column":62}},"text":"a"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":62},"end":{"row":61,"column":63}},"text":"l"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":63},"end":{"row":61,"column":64}},"text":"u"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":61,"column":64},"end":{"row":61,"column":65}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":60,"column":46},"end":{"row":60,"column":48}},"text":"ty"},{"action":"insertText","range":{"start":{"row":60,"column":46},"end":{"row":60,"column":47}},"text":"u"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":60,"column":47},"end":{"row":60,"column":48}},"text":"a"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":60,"column":48},"end":{"row":60,"column":49}},"text":"n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":60,"column":49},"end":{"row":60,"column":50}},"text":"t"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":60,"column":50},"end":{"row":60,"column":51}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":60,"column":51},"end":{"row":60,"column":52}},"text":"t"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":60,"column":52},"end":{"row":60,"column":53}},"text":"y"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":62,"column":72},"end":{"row":62,"column":73}},"text":";"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":54,"column":70},"end":{"row":54,"column":71}},"text":";"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":56,"column":54},"end":{"row":56,"column":55}},"text":";"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":82,"column":0},"end":{"row":82,"column":15}},"text":"            });"},{"action":"removeLines","range":{"start":{"row":67,"column":0},"end":{"row":82,"column":0}},"nl":"\n","lines":["","            _(_data[dataset])","                .groupBy('owner')","                .each(function(v, k) {","                    result[k] = {'owner' : k , 'grossValue' : 0, 'quantity' : 0};","                    _.each(v, function(o) { ","                        result[k].owner = k;","                        result[k].grossValue += o.grossValue;","                        result[k].quantity += o.quantity;","                    });","                });","            ","            _.chain(result).pluck().each(function(r) {","                r.vsTarget = -target + r.grossValue;","                r.vsTargetPercentage = r.grossValue / target;"]}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":45,"column":0},"end":{"row":45,"column":29}},"text":"            var result2 = [];"},{"action":"removeLines","range":{"start":{"row":43,"column":0},"end":{"row":45,"column":0}},"nl":"\n","lines":["            ","            var result = {};"]}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":44,"column":0},"end":{"row":44,"column":12}},"text":"            "},{"action":"removeLines","range":{"start":{"row":43,"column":0},"end":{"row":44,"column":0}},"nl":"\n","lines":[""]}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":63,"column":25},"end":{"row":64,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":59,"column":51},"end":{"row":59,"column":52}},"text":"r"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":51},"end":{"row":59,"column":52}},"text":"s"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":52},"end":{"row":59,"column":53}},"text":"u"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":59,"column":53},"end":{"row":59,"column":54}},"text":"m"}]}]]},"ace":{"folds":[],"scrolltop":540,"scrollleft":0,"selection":{"start":{"row":45,"column":33},"end":{"row":45,"column":33},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1407695548906,"hash":"0c72472d81e81fa092c93b8a18fec65506962259"}