{"filter":false,"title":"headline-opportunities.js","tooltip":"/models/headline-opportunities.js","undoManager":{"mark":100,"position":100,"stack":[[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":168,"column":23},"end":{"row":168,"column":24}},"text":"t"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":168,"column":24},"end":{"row":168,"column":25}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":168,"column":28},"end":{"row":168,"column":29}},"text":"4"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":168,"column":28},"end":{"row":168,"column":60}},"text":"d.mDate.add('weeks', storeWeeks)"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":168,"column":49},"end":{"row":168,"column":59}},"text":"storeWeeks"},{"action":"insertText","range":{"start":{"row":168,"column":49},"end":{"row":168,"column":50}},"text":"4"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":167,"column":32},"end":{"row":167,"column":33}},"text":"4"},{"action":"insertText","range":{"start":{"row":167,"column":32},"end":{"row":167,"column":72}},"text":"d.mDate.subtract('weeks', deliveryWeeks)"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":167,"column":24},"end":{"row":167,"column":29}},"text":"Weeks"},{"action":"insertText","range":{"start":{"row":167,"column":24},"end":{"row":167,"column":25}},"text":"D"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":167,"column":25},"end":{"row":167,"column":26}},"text":"a"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":167,"column":26},"end":{"row":167,"column":27}},"text":"t"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":167,"column":27},"end":{"row":167,"column":28}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":167,"column":57},"end":{"row":167,"column":70}},"text":"deliveryWeeks"},{"action":"insertText","range":{"start":{"row":167,"column":57},"end":{"row":167,"column":58}},"text":"4"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":169,"column":28},"end":{"row":169,"column":29}},"text":";"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":169,"column":28},"end":{"row":169,"column":29}},"text":","}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":175,"column":37},"end":{"row":175,"column":77}},"text":"d.mDate.subtract('weeks', deliveryWeeks)"},{"action":"insertText","range":{"start":{"row":175,"column":37},"end":{"row":175,"column":38}},"text":"d"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":175,"column":38},"end":{"row":175,"column":39}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":175,"column":39},"end":{"row":175,"column":40}},"text":"l"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":175,"column":40},"end":{"row":175,"column":41}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":175,"column":41},"end":{"row":175,"column":42}},"text":"v"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":175,"column":42},"end":{"row":175,"column":43}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":175,"column":43},"end":{"row":175,"column":44}},"text":"r"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":175,"column":44},"end":{"row":175,"column":45}},"text":"y"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":175,"column":45},"end":{"row":175,"column":46}},"text":"D"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":175,"column":46},"end":{"row":175,"column":47}},"text":"a"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":175,"column":47},"end":{"row":175,"column":48}},"text":"t"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":175,"column":48},"end":{"row":175,"column":49}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":176,"column":37},"end":{"row":176,"column":69}},"text":"d.mDate.add('weeks', storeWeeks)"},{"action":"insertText","range":{"start":{"row":176,"column":37},"end":{"row":176,"column":38}},"text":"t"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":176,"column":37},"end":{"row":176,"column":38}},"text":"t"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":176,"column":37},"end":{"row":176,"column":38}},"text":"s"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":176,"column":38},"end":{"row":176,"column":39}},"text":"t"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":176,"column":39},"end":{"row":176,"column":40}},"text":"o"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":176,"column":40},"end":{"row":176,"column":41}},"text":"r"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":176,"column":41},"end":{"row":176,"column":42}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":176,"column":42},"end":{"row":176,"column":43}},"text":"D"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":176,"column":43},"end":{"row":176,"column":44}},"text":"a"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":176,"column":44},"end":{"row":176,"column":45}},"text":"t"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":176,"column":45},"end":{"row":176,"column":46}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":177,"column":55},"end":{"row":177,"column":59}},"text":"Live"},{"action":"insertText","range":{"start":{"row":177,"column":55},"end":{"row":177,"column":56}},"text":"E"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":177,"column":56},"end":{"row":177,"column":57}},"text":"n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":177,"column":57},"end":{"row":177,"column":58}},"text":"d"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":246,"column":0},"end":{"row":246,"column":17}},"text":"                }"},{"action":"removeLines","range":{"start":{"row":180,"column":0},"end":{"row":246,"column":0}},"nl":"\n","lines":["                ","                var headline = d.recordType === 'Headline' ? true : false;","    ","                var thisWeek = $j.extend({}, d);","                    thisWeek.type = 'Live Date';","                    newData.push(thisWeek);","                ","                if(d.recordType == 'Headline') {","                    ","                    var delWeek = ","                    ","                    for (var i = 1; i <= deliveryWeeks; i++) {","                        ","                        var newIndex = index - (i*7);","                        ","                        while (_modpriv.datesByIndex[newIndex].cyWeekNum == 53) {newIndex--;}","","                        var delWeek = $j.extend({}, d);","                            delWeek.week = _modpriv.datesByIndex[newIndex].fyYearWeek;","                            delWeek.month = _modpriv.datesByIndex[newIndex].fyYearMonth;","                            delWeek.closeDate = _modpriv.datesByIndex[newIndex].cyDate;","                            delWeek.weeklyValue = 0;","                            delWeek.type = 'Delivery';","                        newData.push(delWeek);","                ","                    }","    ","                    for (var i = 1; i <= storeWeeks; i++) {","                        ","                        while (_modpriv.datesByIndex[newIndex].cyWeekNum == 53) {newIndex++;}","                        ","                        var newIndex = index + (i*7);","","                        var storeWeek = $j.extend({}, d);","                            storeWeek.week = _modpriv.datesByIndex[newIndex].fyYearWeek;","                            storeWeek.month = _modpriv.datesByIndex[newIndex].fyYearMonth;","                            storeWeek.closeDate = _modpriv.datesByIndex[newIndex].cyDate;","                            storeWeek.type = 'In Store';","                        newData.push(storeWeek);","                    ","                    }","                ","                }","                ","                if (!d.isPromotion) {","                ","                    var maxIndex = 1826; ","                    var add = headline ? storeWeeks * 7 : 0;","                    var start = index + add;","                    var remainingWeeks = Math.floor((maxIndex - start) / 7);","","                    for (var i = 1; i <= remainingWeeks; i++) {","                        ","                        var newIndex = start + (i*7);","                        ","                        while (_modpriv.datesByIndex[newIndex].cyWeekNum == 53) {newIndex++;}","                    ","                        var saleWeek = $j.extend({}, d);","                            saleWeek.week = _modpriv.datesByIndex[newIndex].fyYearWeek;","                            saleWeek.month = _modpriv.datesByIndex[newIndex].fyYearMonth;","                            saleWeek.closeDate = _modpriv.datesByIndex[newIndex].cyDate;","                            saleWeek.type = headline ? 'Sales' : 'Loss';","                        newData.push(saleWeek);","                    ","                    }","                "]},{"action":"removeText","range":{"start":{"row":179,"column":5},"end":{"row":179,"column":72}},"text":"           var index = _modpriv.datesByDate[d.closeDate].dateIndex;"},{"action":"removeText","range":{"start":{"row":179,"column":5},"end":{"row":180,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":179,"column":4},"end":{"row":179,"column":5}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":179,"column":0},"end":{"row":179,"column":4}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":178,"column":0},"end":{"row":179,"column":0}},"nl":"\n","lines":[""]}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":177,"column":84},"end":{"row":178,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":177,"column":83},"end":{"row":177,"column":84}},"text":";"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":177,"column":83},"end":{"row":177,"column":84}},"text":";"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":9,"column":29},"end":{"row":10,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":10,"column":0},"end":{"row":10,"column":12}},"text":"            "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":12},"end":{"row":10,"column":13}},"text":"_"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":13},"end":{"row":10,"column":14}},"text":"d"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":14},"end":{"row":10,"column":15}},"text":"a"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":15},"end":{"row":10,"column":16}},"text":"t"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":16},"end":{"row":10,"column":17}},"text":"a"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":17},"end":{"row":10,"column":18}},"text":"T"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":18},"end":{"row":10,"column":19}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":19},"end":{"row":10,"column":20}},"text":"m"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":20},"end":{"row":10,"column":21}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":21},"end":{"row":10,"column":22}},"text":"l"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":22},"end":{"row":10,"column":23}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":23},"end":{"row":10,"column":24}},"text":"n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":24},"end":{"row":10,"column":25}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":25},"end":{"row":10,"column":26}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":26},"end":{"row":10,"column":27}},"text":"="}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":27},"end":{"row":10,"column":28}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":28},"end":{"row":10,"column":30}},"text":"[]"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":30},"end":{"row":10,"column":31}},"text":";"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":51,"column":67},"end":{"row":52,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":52,"column":0},"end":{"row":52,"column":24}},"text":"                        "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":52,"column":24},"end":{"row":52,"column":67}},"text":"_dataByWeek = _dataTransformToWeeks(_data);"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":52,"column":29},"end":{"row":52,"column":30}},"text":"B"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":52,"column":29},"end":{"row":52,"column":30}},"text":"y"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":52,"column":29},"end":{"row":52,"column":30}},"text":"W"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":52,"column":29},"end":{"row":52,"column":30}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":52,"column":29},"end":{"row":52,"column":30}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":52,"column":29},"end":{"row":52,"column":30}},"text":"k"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":52,"column":29},"end":{"row":52,"column":30}},"text":"T"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":52,"column":30},"end":{"row":52,"column":31}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":52,"column":31},"end":{"row":52,"column":32}},"text":"m"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":52,"column":32},"end":{"row":52,"column":33}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":52,"column":33},"end":{"row":52,"column":34}},"text":"l"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":52,"column":34},"end":{"row":52,"column":35}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":52,"column":35},"end":{"row":52,"column":36}},"text":"n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":52,"column":36},"end":{"row":52,"column":37}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":52,"column":56},"end":{"row":52,"column":61}},"text":"Weeks"},{"action":"insertText","range":{"start":{"row":52,"column":56},"end":{"row":52,"column":57}},"text":"T"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":52,"column":57},"end":{"row":52,"column":58}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":52,"column":58},"end":{"row":52,"column":59}},"text":"m"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":52,"column":59},"end":{"row":52,"column":60}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":52,"column":60},"end":{"row":52,"column":61}},"text":"l"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":52,"column":61},"end":{"row":52,"column":62}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":52,"column":62},"end":{"row":52,"column":63}},"text":"n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":52,"column":63},"end":{"row":52,"column":64}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":172,"column":0},"end":{"row":172,"column":65}},"text":"                maxDate = new moment('2014-12-31', 'YYYY-MM-DD');"},{"action":"removeLines","range":{"start":{"row":169,"column":0},"end":{"row":172,"column":0}},"nl":"\n","lines":["            var deliveryDate = d.mDate.subtract('weeks', 4),","                storeDate = d.mDate.add('weeks', 4),","                newData = [],"]}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":171,"column":46},"end":{"row":172,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":172,"column":0},"end":{"row":172,"column":16}},"text":"                "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":172,"column":16},"end":{"row":173,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":173,"column":0},"end":{"row":173,"column":16}},"text":"                "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":173,"column":16},"end":{"row":173,"column":76}},"text":"            var deliveryDate = d.mDate.subtract('weeks', 4),"},{"action":"insertText","range":{"start":{"row":173,"column":76},"end":{"row":174,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":174,"column":0},"end":{"row":176,"column":0}},"lines":["                storeDate = d.mDate.add('weeks', 4),","                newData = [],"]},{"action":"insertText","range":{"start":{"row":176,"column":0},"end":{"row":176,"column":65}},"text":"                maxDate = new moment('2014-12-31', 'YYYY-MM-DD');"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":173,"column":24},"end":{"row":173,"column":28}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":173,"column":20},"end":{"row":173,"column":24}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":173,"column":16},"end":{"row":173,"column":20}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":174,"column":16},"end":{"row":174,"column":20}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":175,"column":16},"end":{"row":175,"column":20}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":176,"column":16},"end":{"row":176,"column":20}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":168,"column":0},"end":{"row":168,"column":12}},"text":"            "},{"action":"removeText","range":{"start":{"row":167,"column":57},"end":{"row":168,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":167,"column":57},"end":{"row":168,"column":0}},"text":"\n"}]}]]},"ace":{"folds":[],"scrolltop":1669.5,"scrollleft":0,"selection":{"start":{"row":171,"column":44},"end":{"row":171,"column":44},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":118,"state":"no_regex","mode":"ace/mode/javascript"}},"timestamp":1407875968551,"hash":"704267a8a41841a518d7a50fa04592856a5340a1"}